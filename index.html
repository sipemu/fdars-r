<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>fdars - Functional Data Analysis in Rust • fdars</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="fdars - Functional Data Analysis in Rust">
<meta name="description" content="Functional data analysis tools with a high-performance Rust backend. Provides methods for functional data manipulation, depth computation, distance metrics, regression, and statistical testing. Supports both 1D functional data (curves) and 2D functional data (surfaces).">
<meta property="og:description" content="Functional data analysis tools with a high-performance Rust backend. Provides methods for functional data manipulation, depth computation, distance metrics, regression, and statistical testing. Supports both 1D functional data (curves) and 2D functional data (surfaces).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fdars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="articles/introduction.html">Introduction to fdars</a></li>
    <li><a class="dropdown-item" href="articles/custom-plotting.html">Custom Plotting with ggplot2</a></li>
    <li><a class="dropdown-item" href="articles/intro-to-smoothing.html">Introduction to Smoothing</a></li>
    <li><a class="dropdown-item" href="articles/working-with-derivatives.html">Working with Derivatives</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Methods</h6></li>
    <li><a class="dropdown-item" href="articles/fpca.html">Functional PCA (FPCA)</a></li>
    <li><a class="dropdown-item" href="articles/basis-representation.html">Basis Representation</a></li>
    <li><a class="dropdown-item" href="articles/depth-functions.html">Depth Functions</a></li>
    <li><a class="dropdown-item" href="articles/distance-metrics.html">Distance Metrics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="articles/outlier-detection.html">Outlier Detection</a></li>
    <li><a class="dropdown-item" href="articles/regression.html">Regression</a></li>
    <li><a class="dropdown-item" href="articles/seasonal-analysis.html">Seasonal Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="articles/covariance-functions.html">Covariance Functions</a></li>
    <li><a class="dropdown-item" href="articles/simulation-toolbox.html">Simulation Toolbox</a></li>
    <li><a class="dropdown-item" href="articles/irregular-sampling.html">Irregular Sampling</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sipemu/fdars-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fdars">fdars<a class="anchor" aria-label="anchor" href="#fdars"></a>
</h1></div>
<p><a href="https://github.com/sipemu/fdars-r/actions/workflows/r-cmd-check.yml" class="external-link"><img src="https://github.com/sipemu/fdars-r/actions/workflows/r-cmd-check.yml/badge.svg" alt="R-CMD-check"></a> <a href="https://CRAN.R-project.org/package=fdars" class="external-link"><img src="https://www.r-pkg.org/badges/version/fdars" alt="CRAN status"></a> <a href="https://cran.r-project.org/package=fdars" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/fdars" alt="CRAN downloads"></a> <a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a> <a href="https://app.codecov.io/gh/sipemu/fdars-r" class="external-link"><img src="https://codecov.io/gh/sipemu/fdars-r/graph/badge.svg" alt="codecov"></a></p>
<p><strong>Functional Data Analysis in Rust</strong> - A high-performance R package for functional data analysis with a Rust backend.</p>
<div class="section level2">
<h2 id="what-is-functional-data-analysis">What is Functional Data Analysis?<a class="anchor" aria-label="anchor" href="#what-is-functional-data-analysis"></a>
</h2>
<p>Functional Data Analysis (FDA) is a branch of statistics that deals with data where each observation is a function, curve, or surface rather than a single number or vector. Examples include:</p>
<ul>
<li>
<strong>Temperature curves</strong>: Daily temperature recordings over a year for multiple weather stations</li>
<li>
<strong>Growth curves</strong>: Height measurements of children tracked over time</li>
<li>
<strong>Spectroscopy data</strong>: Absorbance spectra measured across wavelengths</li>
<li>
<strong>Financial trajectories</strong>: Stock price movements over trading days</li>
<li>
<strong>Medical signals</strong>: ECG, EEG, or fMRI time series</li>
</ul>
<p>Traditional statistical methods treat each time point as a separate variable, losing the inherent smoothness and continuity of the data. FDA treats the entire curve as a single observation, enabling more powerful and interpretable analyses.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>fdars is a comprehensive toolkit for functional data analysis with a high-performance Rust backend providing 10-200x speedups over pure R implementations.</p>
<div class="section level3">
<h3 id="data-representation">Data Representation<a class="anchor" aria-label="anchor" href="#data-representation"></a>
</h3>
<ul>
<li>
<strong>1D functional data</strong> - Curves, time series, spectra</li>
<li>
<strong>2D functional data</strong> - Surfaces, images, spatial fields</li>
<li>
<strong>Metadata support</strong> - Attach IDs and covariates to observations</li>
<li>
<strong>Flexible I/O</strong> - Create from matrices, arrays, or data frames</li>
</ul>
</div>
<div class="section level3">
<h3 id="depth--centrality">Depth &amp; Centrality<a class="anchor" aria-label="anchor" href="#depth--centrality"></a>
</h3>
<p>Measure how “central” or “typical” each curve is: - Fraiman-Muniz (FM), Band depth (BD), Modified band depth (MBD) - Modal depth, Random projection (RP, RT, RPD) - Functional spatial depth (FSD, KFSD) - Depth-based median, trimmed mean, trimmed variance</p>
</div>
<div class="section level3">
<h3 id="outlier-detection">Outlier Detection<a class="anchor" aria-label="anchor" href="#outlier-detection"></a>
</h3>
<p>Multiple approaches to identify anomalous curves: - Depth-based trimming and weighting - Likelihood ratio test (LRT) - Functional boxplot - Magnitude-Shape plot (magnitude vs shape outliers) - Outliergram (MEI vs MBD)</p>
</div>
<div class="section level3">
<h3 id="distance--similarity">Distance &amp; Similarity<a class="anchor" aria-label="anchor" href="#distance--similarity"></a>
</h3>
<p>Quantify differences between curves: - Lp distances (L1, L2, L∞) - Hausdorff distance - Dynamic time warping (DTW) - PCA-based and derivative-based semimetrics</p>
</div>
<div class="section level3">
<h3 id="regression">Regression<a class="anchor" aria-label="anchor" href="#regression"></a>
</h3>
<p>Predict scalar outcomes from functional predictors: - Principal component regression (<code>fregre.pc</code>) - Basis expansion regression (<code>fregre.basis</code>) - Nonparametric kernel regression (<code>fregre.np</code>) - Cross-validation for model selection</p>
</div>
<div class="section level3">
<h3 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h3>
<p>Group similar curves together: - K-means clustering with K-means++ initialization - Fuzzy C-means with soft membership - Automatic selection of optimal k (silhouette, CH, elbow)</p>
</div>
<div class="section level3">
<h3 id="smoothing--basis-expansion">Smoothing &amp; Basis Expansion<a class="anchor" aria-label="anchor" href="#smoothing--basis-expansion"></a>
</h3>
<ul>
<li>Nadaraya-Watson, local linear/polynomial regression</li>
<li>B-spline and Fourier basis expansions</li>
<li>P-splines with automatic smoothing parameter selection</li>
<li>Cross-validation (GCV, AIC, BIC) for basis selection</li>
</ul>
</div>
<div class="section level3">
<h3 id="functional-statistics">Functional Statistics<a class="anchor" aria-label="anchor" href="#functional-statistics"></a>
</h3>
<ul>
<li>Mean, variance, standard deviation, covariance</li>
<li>Geometric median (L1 median)</li>
<li>Bootstrap confidence intervals</li>
<li>Hypothesis testing for functional means</li>
</ul>
</div>
<div class="section level3">
<h3 id="gaussian-process-simulation">Gaussian Process Simulation<a class="anchor" aria-label="anchor" href="#gaussian-process-simulation"></a>
</h3>
<p>Generate synthetic functional data: - Multiple covariance kernels (Gaussian, Matérn, Exponential, Periodic) - Kernel composition (addition, multiplication) - Brownian motion and Ornstein-Uhlenbeck processes</p>
</div>
<div class="section level3">
<h3 id="group-comparison">Group Comparison<a class="anchor" aria-label="anchor" href="#group-comparison"></a>
</h3>
<ul>
<li>Between-group distance matrices (centroid, Hausdorff, depth-based)</li>
<li>Permutation tests for significant group differences</li>
<li>Visualization (heatmaps, dendrograms)</li>
</ul>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<ul>
<li>Curve plots with categorical/continuous coloring</li>
<li>Group means and confidence intervals</li>
<li>Functional boxplots</li>
<li>FPCA component visualization</li>
<li>Outlier diagnostic plots</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<ul>
<li>R (&gt;= 4.0)</li>
<li>Rust toolchain (install from <a href="https://rustup.rs/" class="external-link">rustup.rs</a>)</li>
<li>A C compiler (gcc, clang)</li>
</ul>
</div>
<div class="section level3">
<h3 id="from-github">From GitHub<a class="anchor" aria-label="anchor" href="#from-github"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install remotes if needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install fdars (with documentation)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"sipemu/fdars-r"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> On Windows, you may need <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a> installed.</p>
</div>
<div class="section level3">
<h3 id="from-binary-release-no-rust-required">From Binary Release (No Rust Required)<a class="anchor" aria-label="anchor" href="#from-binary-release-no-rust-required"></a>
</h3>
<p>Download the pre-built binary from <a href="https://github.com/sipemu/fdars-r/releases" class="external-link">GitHub Releases</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># macOS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"path/to/fdars_x.y.z.tgz"</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"mac.binary"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Windows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"path/to/fdars_x.y.z.zip"</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"win.binary"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-source">From Source<a class="anchor" aria-label="anchor" href="#from-source"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Clone the repository</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/sipemu/fdars-r.git</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">cd</span> fdars-r</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Build and install</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">R</span> CMD build .</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">R</span> CMD INSTALL fdars_<span class="pp">*</span>.tar.gz</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sipemu.github.io/fdars-r/">fdars</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create functional data from a matrix (rows = observations, cols = time points)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, argvals <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute depth - measures how "central" each curve is</span></span>
<span><span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>  <span class="co"># default: FM method</span></span>
<span><span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span>  <span class="co"># or specify method</span></span>
<span></span>
<span><span class="co"># Find the functional median (most central curve)</span></span>
<span><span class="va">median_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/median.html">median</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>  <span class="co"># default: FM method</span></span>
<span></span>
<span><span class="co"># Detect outliers</span></span>
<span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/outliers.depth.trim.html">outliers.depth.trim</a></span><span class="op">(</span><span class="va">fd</span>, trim <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Functional regression: predict scalar y from functional X</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fregre.pc.html">fregre.pc</a></span><span class="op">(</span><span class="va">fd</span>, <span class="va">y</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">fd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cluster curves into groups</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cluster.kmeans.html">cluster.kmeans</a></span><span class="op">(</span><span class="va">fd</span>, ncl <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Smooth noisy curves</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/S.NW.html">S.NW</a></span><span class="op">(</span><span class="va">t</span>, h <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># Nadaraya-Watson smoother</span></span>
<span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-concepts">Key Concepts<a class="anchor" aria-label="anchor" href="#key-concepts"></a>
</h2>
<div class="section level3">
<h3 id="functional-data-objects-fdata">Functional Data Objects (<code>fdata</code>)<a class="anchor" aria-label="anchor" href="#functional-data-objects-fdata"></a>
</h3>
<p>The <code>fdata</code> class stores functional data as a matrix where rows are observations and columns are evaluation points:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">data_matrix</span>, argvals <span class="op">=</span> <span class="va">time_points</span>, rangeval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="identifiers-and-metadata">Identifiers and Metadata<a class="anchor" aria-label="anchor" href="#identifiers-and-metadata"></a>
</h4>
<p>You can attach identifiers and metadata (covariates) to functional data objects:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create fdata with IDs and metadata</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">32</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"patient_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>, metadata <span class="op">=</span> <span class="va">meta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access fields</span></span>
<span><span class="va">fd</span><span class="op">$</span><span class="va">id</span>              <span class="co"># Character vector of identifiers</span></span>
<span><span class="va">fd</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">group</span>  <span class="co"># Access metadata columns</span></span>
<span></span>
<span><span class="co"># Subsetting preserves metadata</span></span>
<span><span class="va">fd_sub</span> <span class="op">&lt;-</span> <span class="va">fd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>  <span class="co"># id and metadata are also subsetted</span></span>
<span></span>
<span><span class="co"># View metadata info</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>    <span class="co"># Shows metadata columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>  <span class="co"># Shows metadata types and ranges</span></span></code></pre></div>
<p><strong>Note:</strong> If metadata contains an <code>id</code> column or has non-default row names, they must match the fdata identifiers. An error is thrown on mismatch.</p>
</div>
</div>
<div class="section level3">
<h3 id="depth-functions">Depth Functions<a class="anchor" aria-label="anchor" href="#depth-functions"></a>
</h3>
<p>Depth measures how “central” or “typical” a curve is relative to a sample. Higher depth = more central.</p>
<p>Use the unified <code><a href="reference/depth.html">depth()</a></code> function with a <code>method</code> parameter:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"FM"</span><span class="op">)</span>     <span class="co"># Fraiman-Muniz depth (default)</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"BD"</span><span class="op">)</span>     <span class="co"># Band depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"MBD"</span><span class="op">)</span>    <span class="co"># Modified band depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span>   <span class="co"># Modal depth (kernel density)</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"RP"</span><span class="op">)</span>     <span class="co"># Random projection depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"RT"</span><span class="op">)</span>     <span class="co"># Random Tukey depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"FSD"</span><span class="op">)</span>    <span class="co"># Functional spatial depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"KFSD"</span><span class="op">)</span>   <span class="co"># Kernel functional spatial depth</span></span>
<span><span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"RPD"</span><span class="op">)</span>    <span class="co"># Random projection with derivatives</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="functional-regression">Functional Regression<a class="anchor" aria-label="anchor" href="#functional-regression"></a>
</h3>
<p>Predict a scalar response from functional predictors:</p>
<ul>
<li>
<code>fregre.pc</code> - Principal component regression</li>
<li>
<code>fregre.basis</code> - Basis expansion regression</li>
<li>
<code>fregre.np</code> - Nonparametric kernel regression</li>
</ul>
<p>All models support <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> for new data.</p>
</div>
<div class="section level3">
<h3 id="distance-metrics">Distance Metrics<a class="anchor" aria-label="anchor" href="#distance-metrics"></a>
</h3>
<p>Measure similarity between curves using <code><a href="reference/metric.html">metric()</a></code> with a method parameter:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/metric.html">metric</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"lp"</span><span class="op">)</span>        <span class="co"># Lp distance (default, L2 = Euclidean)</span></span>
<span><span class="fu"><a href="reference/metric.html">metric</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"hausdorff"</span><span class="op">)</span> <span class="co"># Hausdorff distance</span></span>
<span><span class="fu"><a href="reference/metric.html">metric</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"dtw"</span><span class="op">)</span>       <span class="co"># Dynamic time warping</span></span>
<span><span class="fu"><a href="reference/metric.html">metric</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"pca"</span><span class="op">)</span>       <span class="co"># PCA-based semimetric</span></span>
<span><span class="fu"><a href="reference/metric.html">metric</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"deriv"</span><span class="op">)</span>     <span class="co"># Derivative-based semimetric</span></span></code></pre></div>
<p>Individual functions are also available: <code>metric.lp</code>, <code>metric.hausdorff</code>, <code>metric.DTW</code>, <code>semimetric.pca</code>, <code>semimetric.deriv</code>.</p>
</div>
<div class="section level3">
<h3 id="outlier-detection-1">Outlier Detection<a class="anchor" aria-label="anchor" href="#outlier-detection-1"></a>
</h3>
<p>Identify unusual curves:</p>
<ul>
<li>
<code>outliers.depth.trim</code> - Trimmed depth-based detection</li>
<li>
<code>outliers.depth.pond</code> - Weighted depth-based detection</li>
<li>
<code>outliers.lrt</code> - Likelihood ratio test</li>
<li>
<code>outliers.boxplot</code> - Functional boxplot-based detection</li>
<li>
<code>magnitudeshape</code> - Magnitude-Shape outlier detection</li>
<li>
<code>outliergram</code> - Outliergram (MEI vs MBD plot)</li>
</ul>
<div class="section level4">
<h4 id="labeling-outliers-by-id-or-metadata">Labeling Outliers by ID or Metadata<a class="anchor" aria-label="anchor" href="#labeling-outliers-by-id-or-metadata"></a>
</h4>
<p>Both <code>magnitudeshape</code> and <code>outliergram</code> support labeling points by ID or metadata columns:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create fdata with IDs and metadata</span></span>
<span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"patient_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>            metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>subject_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Outliergram with custom labels</span></span>
<span><span class="va">og</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/outliergram.html">outliergram</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">og</span>, label <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>           <span class="co"># Label outliers with patient IDs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">og</span>, label <span class="op">=</span> <span class="st">"subject_id"</span><span class="op">)</span>   <span class="co"># Label with metadata column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">og</span>, label_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>       <span class="co"># Label ALL points, not just outliers</span></span>
<span></span>
<span><span class="co"># magnitudeshape with custom labels</span></span>
<span><span class="fu"><a href="reference/magnitudeshape.html">magnitudeshape</a></span><span class="op">(</span><span class="va">fd</span>, label <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>        <span class="co"># Label outliers with patient IDs</span></span>
<span><span class="fu"><a href="reference/magnitudeshape.html">magnitudeshape</a></span><span class="op">(</span><span class="va">fd</span>, label <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>        <span class="co"># No labels</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="functional-statistics-1">Functional Statistics<a class="anchor" aria-label="anchor" href="#functional-statistics-1"></a>
</h3>
<ul>
<li>
<code>mean(fd)</code> - Functional mean</li>
<li>
<code>var(fd)</code> - Functional variance</li>
<li>
<code>sd(fd)</code> - Functional standard deviation</li>
<li>
<code>cov(fd)</code> - Functional covariance</li>
<li>
<code>gmed(fd)</code> - Geometric median (L1 median via Weiszfeld algorithm)</li>
</ul>
</div>
<div class="section level3">
<h3 id="covariance-functions-and-gaussian-process-generation">Covariance Functions and Gaussian Process Generation<a class="anchor" aria-label="anchor" href="#covariance-functions-and-gaussian-process-generation"></a>
</h3>
<p>Generate synthetic functional data from Gaussian processes with various covariance kernels:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Smooth samples with Gaussian (squared exponential) kernel</span></span>
<span><span class="va">fd_smooth</span> <span class="op">&lt;-</span> <span class="fu">make_gaussian_process</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                                   cov <span class="op">=</span> <span class="fu">kernel_gaussian</span><span class="op">(</span>length_scale <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rough samples with Matern kernel</span></span>
<span><span class="va">fd_rough</span> <span class="op">&lt;-</span> <span class="fu">make_gaussian_process</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                                  cov <span class="op">=</span> <span class="fu">kernel_matern</span><span class="op">(</span>nu <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Periodic samples</span></span>
<span><span class="va">fd_periodic</span> <span class="op">&lt;-</span> <span class="fu">make_gaussian_process</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>                                     cov <span class="op">=</span> <span class="fu">kernel_periodic</span><span class="op">(</span>period <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine kernels: signal + noise</span></span>
<span><span class="va">cov_total</span> <span class="op">&lt;-</span> <span class="fu">kernel_add</span><span class="op">(</span><span class="fu">kernel_gaussian</span><span class="op">(</span>variance <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu">kernel_whitenoise</span><span class="op">(</span>variance <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fd_noisy</span> <span class="op">&lt;-</span> <span class="fu">make_gaussian_process</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">cov_total</span><span class="op">)</span></span></code></pre></div>
<p>Available covariance functions: - <code>kernel_gaussian</code> - Squared exponential (RBF) kernel, infinitely smooth - <code>kernel_exponential</code> - Exponential kernel (Matern ν=0.5), rough - <code>kernel_matern</code> - Matern family with smoothness parameter ν - <code>kernel_brownian</code> - Brownian motion covariance (1D only) - <code>kernel_linear</code> - Linear kernel - <code>kernel_polynomial</code> - Polynomial kernel - <code>kernel_whitenoise</code> - Independent noise at each point - <code>kernel_periodic</code> - Periodic kernel (1D only) - <code>kernel_add</code> - Combine kernels by addition - <code>kernel_mult</code> - Combine kernels by multiplication</p>
</div>
<div class="section level3">
<h3 id="depth-based-medians-and-trimmed-means">Depth-Based Medians and Trimmed Means<a class="anchor" aria-label="anchor" href="#depth-based-medians-and-trimmed-means"></a>
</h3>
<p>Use the unified functions with a <code>method</code> parameter:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Median (curve with maximum depth)</span></span>
<span><span class="fu"><a href="reference/median.html">median</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span>                          <span class="co"># default: FM method</span></span>
<span><span class="fu"><a href="reference/median.html">median</a></span><span class="op">(</span><span class="va">fd</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span>         <span class="co"># modal depth-based median</span></span>
<span></span>
<span><span class="co"># Trimmed mean (mean of deepest curves)</span></span>
<span><span class="fu"><a href="reference/trimmed.html">trimmed</a></span><span class="op">(</span><span class="va">fd</span>, trim <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>             <span class="co"># default: FM method</span></span>
<span><span class="fu"><a href="reference/trimmed.html">trimmed</a></span><span class="op">(</span><span class="va">fd</span>, trim <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"RP"</span><span class="op">)</span>  <span class="co"># RP depth-based trimmed mean</span></span>
<span></span>
<span><span class="co"># Trimmed variance</span></span>
<span><span class="fu"><a href="reference/trimvar.html">trimvar</a></span><span class="op">(</span><span class="va">fd</span>, trim <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>             <span class="co"># default: FM method</span></span>
<span><span class="fu"><a href="reference/trimvar.html">trimvar</a></span><span class="op">(</span><span class="va">fd</span>, trim <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-1">Visualization<a class="anchor" aria-label="anchor" href="#visualization-1"></a>
</h3>
<ul>
<li>
<code>plot(fd, color = ...)</code> - Plot curves with coloring by numeric or categorical variables
<ul>
<li>
<code>show.mean = TRUE</code> - Overlay group mean curves</li>
<li>
<code>show.ci = TRUE</code> - Show confidence interval ribbons per group</li>
</ul>
</li>
<li>
<code>boxplot.fdata</code> - Functional boxplot with depth-based envelopes</li>
<li>
<code>magnitudeshape</code> - Magnitude-Shape outlier detection and visualization</li>
<li>
<code>outliergram</code> - Outliergram for shape outlier detection (MEI vs MBD plot)</li>
<li>
<code>plot.fdata2pc</code> - FPCA visualization (components, variance, scores)</li>
</ul>
</div>
<div class="section level3">
<h3 id="group-comparison-1">Group Comparison<a class="anchor" aria-label="anchor" href="#group-comparison-1"></a>
</h3>
<ul>
<li>
<code>group.distance</code> - Compute distances between groups (centroid, Hausdorff, depth-based)</li>
<li>
<code>group.test</code> - Permutation test for significant group differences</li>
<li>
<code>plot.group.distance</code> - Visualize group distances (heatmap, dendrogram)</li>
</ul>
</div>
<div class="section level3">
<h3 id="clustering-1">Clustering<a class="anchor" aria-label="anchor" href="#clustering-1"></a>
</h3>
<ul>
<li>
<code>cluster.kmeans</code> - K-means clustering for functional data</li>
<li>
<code>cluster.optim</code> - Optimal k selection using silhouette, CH, or elbow</li>
<li>
<code>cluster.fcm</code> - Fuzzy C-means clustering with soft membership</li>
<li>
<code>cluster.init</code> - K-means++ center initialization</li>
</ul>
</div>
<div class="section level3">
<h3 id="curve-registration">Curve Registration<a class="anchor" aria-label="anchor" href="#curve-registration"></a>
</h3>
<ul>
<li>
<code>register.fd</code> - Shift registration using cross-correlation</li>
</ul>
</div>
<div class="section level3">
<h3 id="feature-extraction">Feature Extraction<a class="anchor" aria-label="anchor" href="#feature-extraction"></a>
</h3>
<ul>
<li>
<code>localavg.fdata</code> - Extract local average features from curves</li>
</ul>
</div>
<div class="section level3">
<h3 id="id_2d-functional-data-surfaces">2D Functional Data (Surfaces)<a class="anchor" aria-label="anchor" href="#id_2d-functional-data-surfaces"></a>
</h3>
<p>fdars supports 2D functional data (surfaces/images). The following functions have full 2D support:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Category</th>
<th>Functions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Depth</strong></td>
<td>
<code>depth</code> (methods: FM, mode, RP, RT, FSD, KFSD)</td>
</tr>
<tr class="even">
<td><strong>Distance</strong></td>
<td>
<code>metric.lp</code>, <code>metric.hausdorff</code>, <code>semimetric.pca</code>, <code>semimetric.deriv</code>
</td>
</tr>
<tr class="odd">
<td><strong>Statistics</strong></td>
<td>
<code>mean</code>, <code>var</code>, <code>sd</code>, <code>cov</code>, <code>gmed</code>, <code>deriv</code>
</td>
</tr>
<tr class="even">
<td><strong>Centrality</strong></td>
<td>
<code>median</code>, <code>trimmed</code>, <code>trimvar</code> (all methods except BD, MBD, RPD)</td>
</tr>
<tr class="odd">
<td><strong>Regression</strong></td>
<td>
<code>fregre.np</code> (nonparametric)</td>
</tr>
<tr class="even">
<td><strong>Visualization</strong></td>
<td>
<code>plot</code> (heatmap + contours)</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Band depths (BD, MBD), RPD, and DTW do not support 2D data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create 2D functional data (e.g., 10 surfaces on a 20x30 grid)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">m1</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">m2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate surfaces: f(s,t) = sin(2*pi*s) * cos(2*pi*t) + noise</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">si</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">ti</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="va">si</span>, <span class="va">ti</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">s</span><span class="op">[</span><span class="va">si</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">[</span><span class="va">ti</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fd2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, argvals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">t</span><span class="op">)</span>, fdata2d <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All these work with 2D data:</span></span>
<span><span class="va">mean_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span>           <span class="co"># Mean surface</span></span>
<span><span class="va">var_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.html">var</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span>             <span class="co"># Pointwise variance</span></span>
<span><span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/depth.html">depth</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span>                <span class="co"># Depth values</span></span>
<span><span class="va">median_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/median.html">median</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span>       <span class="co"># Depth-based median</span></span>
<span><span class="va">gmed_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gmed.html">gmed</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span>           <span class="co"># Geometric median</span></span>
<span></span>
<span><span class="co"># Plot 2D data (heatmap + contours)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fd2d</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="converting-dataframes-to-2d-fdata">Converting DataFrames to 2D fdata<a class="anchor" aria-label="anchor" href="#converting-dataframes-to-2d-fdata"></a>
</h4>
<p>Use <code><a href="reference/df_to_fdata2d.html">df_to_fdata2d()</a></code> to convert long-format DataFrames to 2D functional data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DataFrame structure: id column, s-index column, t-value columns</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"surf1"</span>, <span class="st">"surf2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  t1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, t2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, t3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to 2D fdata</span></span>
<span><span class="va">fd2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/df_to_fdata2d.html">df_to_fdata2d</a></span><span class="op">(</span><span class="va">df</span>, id_col <span class="op">=</span> <span class="fl">1</span>, s_col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With metadata (must have one row per surface)</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fd2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/df_to_fdata2d.html">df_to_fdata2d</a></span><span class="op">(</span><span class="va">df</span>, id_col <span class="op">=</span> <span class="fl">1</span>, s_col <span class="op">=</span> <span class="fl">2</span>, metadata <span class="op">=</span> <span class="va">meta</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT</p>
</div>
<div class="section level2">
<h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a>
</h2>
<p>Simon Mueller</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<ul>
<li>Built with <a href="https://extendr.rs/" class="external-link">extendr</a> for R-Rust integration</li>
<li>Uses <a href="https://github.com/rayon-rs/rayon" class="external-link">rayon</a> for parallelization</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/sipemu/fdars-r/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/sipemu/fdars-r/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fdars</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Simon Müller <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Müller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
