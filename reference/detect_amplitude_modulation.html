<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect Amplitude Modulation in Seasonal Time Series — detect_amplitude_modulation • fdars</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect Amplitude Modulation in Seasonal Time Series — detect_amplitude_modulation"><meta name="description" content="Detects whether the amplitude of a seasonal pattern changes over time
(amplitude modulation). Uses either Hilbert transform or wavelet analysis
to extract the time-varying amplitude envelope."><meta property="og:description" content="Detects whether the amplitude of a seasonal pattern changes over time
(amplitude modulation). Uses either Hilbert transform or wavelet analysis
to extract the time-varying amplitude envelope."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fdars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to fdars</a></li>
    <li><a class="dropdown-item" href="../articles/custom-plotting.html">Custom Plotting with ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/intro-to-smoothing.html">Introduction to Smoothing</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-derivatives.html">Working with Derivatives</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/fpca.html">Functional PCA (FPCA)</a></li>
    <li><a class="dropdown-item" href="../articles/basis-representation.html">Basis Representation</a></li>
    <li><a class="dropdown-item" href="../articles/depth-functions.html">Depth Functions</a></li>
    <li><a class="dropdown-item" href="../articles/distance-metrics.html">Distance Metrics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/outlier-detection.html">Outlier Detection</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">Regression</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal-analysis.html">Seasonal Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance-functions.html">Covariance Functions</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-toolbox.html">Simulation Toolbox</a></li>
    <li><a class="dropdown-item" href="../articles/irregular-sampling.html">Irregular Sampling</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sipemu/fdars-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect Amplitude Modulation in Seasonal Time Series</h1>
      <small class="dont-index">Source: <a href="https://github.com/sipemu/fdars-r/blob/main/R/seasonal.R" class="external-link"><code>R/seasonal.R</code></a></small>
      <div class="d-none name"><code>detect_amplitude_modulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Detects whether the amplitude of a seasonal pattern changes over time
(amplitude modulation). Uses either Hilbert transform or wavelet analysis
to extract the time-varying amplitude envelope.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_amplitude_modulation</span><span class="op">(</span></span>
<span>  <span class="va">fdataobj</span>,</span>
<span>  <span class="va">period</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hilbert"</span>, <span class="st">"wavelet"</span><span class="op">)</span>,</span>
<span>  modulation_threshold <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  seasonality_threshold <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fdataobj">fdataobj<a class="anchor" aria-label="anchor" href="#arg-fdataobj"></a></dt>
<dd><p>An fdata object.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>Seasonal period in argvals units.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method for amplitude extraction: "hilbert" (default) or "wavelet".</p></dd>


<dt id="arg-modulation-threshold">modulation_threshold<a class="anchor" aria-label="anchor" href="#arg-modulation-threshold"></a></dt>
<dd><p>Coefficient of variation threshold for detecting
modulation. Default: 0.15 (i.e., CV &gt; 15% indicates modulation).</p></dd>


<dt id="arg-seasonality-threshold">seasonality_threshold<a class="anchor" aria-label="anchor" href="#arg-seasonality-threshold"></a></dt>
<dd><p>Strength threshold for seasonality detection.
Default: 0.3.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt>is_seasonal</dt>
<dd><p>Logical, whether seasonality is detected</p></dd>

<dt>seasonal_strength</dt>
<dd><p>Overall seasonal strength (spectral method)</p></dd>

<dt>has_modulation</dt>
<dd><p>Logical, whether amplitude modulation is detected</p></dd>

<dt>modulation_type</dt>
<dd><p>Character: "stable", "emerging", "fading",
"oscillating", or "non_seasonal"</p></dd>

<dt>modulation_score</dt>
<dd><p>Coefficient of variation of amplitude (0 = stable)</p></dd>

<dt>amplitude_trend</dt>
<dd><p>Trend in amplitude (-1 to 1): negative = fading,
positive = emerging</p></dd>

<dt>amplitude_curve</dt>
<dd><p>Time-varying amplitude (fdata object)</p></dd>

<dt>time_points</dt>
<dd><p>Time points for the amplitude curve</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function first checks if seasonality is present using the spectral
method (which is robust to amplitude modulation). If seasonality is
detected, it extracts the amplitude envelope and analyzes its variation.</p>
<p><strong>Hilbert method</strong>: Uses Hilbert transform to compute the analytic
signal and extract instantaneous amplitude. Fast but assumes narrowband
signals.</p>
<p><strong>Wavelet method</strong>: Uses Morlet wavelet transform at the target
period. More robust to noise and non-stationarity.</p>
<p><strong>Modulation types</strong>:</p><ul><li><p><code>stable</code>: Constant amplitude (modulation_score &lt; threshold)</p></li>
<li><p><code>emerging</code>: Amplitude increases over time (amplitude_trend &gt; 0.3)</p></li>
<li><p><code>fading</code>: Amplitude decreases over time (amplitude_trend &lt; -0.3)</p></li>
<li><p><code>oscillating</code>: Amplitude varies but no clear trend</p></li>
<li><p><code>non_seasonal</code>: No seasonality detected</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate data with emerging seasonality</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">t</span>  <span class="co"># Amplitude grows over time</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">amplitude</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">/</span> <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, argvals <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">detect_amplitude_modulation</span><span class="op">(</span><span class="va">fd</span>, period <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">modulation_type</span><span class="op">)</span>  <span class="co"># "emerging"</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "emerging"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">amplitude_trend</span><span class="op">)</span>  <span class="co"># Positive value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare Hilbert vs Wavelet methods</span></span></span>
<span class="r-in"><span><span class="va">result_hilbert</span> <span class="op">&lt;-</span> <span class="fu">detect_amplitude_modulation</span><span class="op">(</span><span class="va">fd</span>, period <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"hilbert"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result_wavelet</span> <span class="op">&lt;-</span> <span class="fu">detect_amplitude_modulation</span><span class="op">(</span><span class="va">fd</span>, period <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"wavelet"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Müller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

