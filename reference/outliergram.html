<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Outliergram for Functional Data — outliergram • fdars</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Outliergram for Functional Data — outliergram"><meta name="description" content="Creates an outliergram plot that displays MEI (Modified Epigraph Index) versus
MBD (Modified Band Depth) for outlier detection. Points below the parabolic
boundary are identified as outliers, and each outlier is classified by type."><meta property="og:description" content="Creates an outliergram plot that displays MEI (Modified Epigraph Index) versus
MBD (Modified Band Depth) for outlier detection. Points below the parabolic
boundary are identified as outliers, and each outlier is classified by type."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fdars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to fdars</a></li>
    <li><a class="dropdown-item" href="../articles/custom-plotting.html">Custom Plotting with ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/intro-to-smoothing.html">Introduction to Smoothing</a></li>
    <li><a class="dropdown-item" href="../articles/working-with-derivatives.html">Working with Derivatives</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/fpca.html">Functional PCA (FPCA)</a></li>
    <li><a class="dropdown-item" href="../articles/basis-representation.html">Basis Representation</a></li>
    <li><a class="dropdown-item" href="../articles/depth-functions.html">Depth Functions</a></li>
    <li><a class="dropdown-item" href="../articles/distance-metrics.html">Distance Metrics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/outlier-detection.html">Outlier Detection</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">Regression</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal-analysis.html">Seasonal Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance-functions.html">Covariance Functions</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-toolbox.html">Simulation Toolbox</a></li>
    <li><a class="dropdown-item" href="../articles/irregular-sampling.html">Irregular Sampling</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sipemu/fdars-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Outliergram for Functional Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sipemu/fdars-r/blob/main/R/outliers.R" class="external-link"><code>R/outliers.R</code></a></small>
      <div class="d-none name"><code>outliergram.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an outliergram plot that displays MEI (Modified Epigraph Index) versus
MBD (Modified Band Depth) for outlier detection. Points below the parabolic
boundary are identified as outliers, and each outlier is classified by type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">outliergram</span><span class="op">(</span><span class="va">fdataobj</span>, factor <span class="op">=</span> <span class="fl">1.5</span>, mei_threshold <span class="op">=</span> <span class="fl">0.25</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fdataobj">fdataobj<a class="anchor" aria-label="anchor" href="#arg-fdataobj"></a></dt>
<dd><p>An object of class 'fdata'.</p></dd>


<dt id="arg-factor">factor<a class="anchor" aria-label="anchor" href="#arg-factor"></a></dt>
<dd><p>Factor to adjust the outlier detection threshold. Higher values
make detection less sensitive. Default is 1.5.</p></dd>


<dt id="arg-mei-threshold">mei_threshold<a class="anchor" aria-label="anchor" href="#arg-mei-threshold"></a></dt>
<dd><p>Threshold for classifying magnitude outliers based on MEI.
Curves with MEI &lt; mei_threshold or MEI &gt; (1 - mei_threshold) are considered
to have extreme magnitude. Default is 0.25.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently ignored).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class 'outliergram' with components:</p><dl><dt>fdataobj</dt>
<dd><p>The input functional data</p></dd>

<dt>mei</dt>
<dd><p>MEI values for each curve</p></dd>

<dt>mbd</dt>
<dd><p>MBD values for each curve</p></dd>

<dt>outliers</dt>
<dd><p>Indices of detected outliers</p></dd>

<dt>outlier_type</dt>
<dd><p>Character vector of outlier types for each detected outlier:
"shape", "magnitude_high", "magnitude_low", or "mixed"</p></dd>

<dt>n_outliers</dt>
<dd><p>Number of outliers detected</p></dd>

<dt>factor</dt>
<dd><p>The factor used for threshold adjustment</p></dd>

<dt>parabola</dt>
<dd><p>Coefficients of the parabolic boundary (a0, a1, a2)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The outliergram plots MEI on the x-axis versus MBD on the y-axis. For standard
functional data, these values lie near a parabola. The theoretical relationship
for uniformly distributed data is:
$$MBD = a_0 + a_1 \cdot MEI + a_2 \cdot MEI^2$$</p>
<p>Points that fall significantly below this parabola are identified as outliers.
The <code>factor</code> parameter controls the sensitivity: lower values detect more
outliers.</p>
<p><strong>Outlier Type Classification:</strong></p><ul><li><p><strong>shape</strong>: Curves with unusual shape but typical magnitude
(moderate MEI, low MBD). These curves cross other curves frequently.</p></li>
<li><p><strong>magnitude_high</strong>: Curves shifted upward (high MEI, typically
above most other curves).</p></li>
<li><p><strong>magnitude_low</strong>: Curves shifted downward (low MEI, typically
below most other curves).</p></li>
<li><p><strong>mixed</strong>: Curves with both unusual shape and extreme magnitude
(extreme MEI and low MBD).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Arribas-Gil, A. and Romo, J. (2014). Shape outlier detection and visualization
for functional data: the outliergram. <em>Biostatistics</em>, 15(4), 603-619.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="depth.html">depth</a></code> for depth computation, <code><a href="magnitudeshape.html">magnitudeshape</a></code> for
an alternative outlier visualization.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create functional data with different outlier types</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">32</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">)</span> <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="fl">30</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span>       <span class="co"># magnitude outlier (high)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="fl">31</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>       <span class="co"># magnitude outlier (low)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="fl">32</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span>           <span class="co"># shape outlier</span></span></span>
<span class="r-in"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span><span class="va">X</span>, argvals <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create outliergram</span></span></span>
<span class="r-in"><span><span class="va">og</span> <span class="op">&lt;-</span> <span class="fu">outliergram</span><span class="op">(</span><span class="va">fd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">og</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outliergram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===========</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of curves: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outliers detected: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outlier types:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Shape:           4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Magnitude (high): 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Magnitude (low):  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outlier details:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 11 : shape </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 19 : shape </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 20 : shape </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 30 : magnitude_high </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 31 : magnitude_low </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Index 32 : shape </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Factor: 1.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MEI threshold: 0.25 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">og</span>, color_by_type <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="outliergram-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Müller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

