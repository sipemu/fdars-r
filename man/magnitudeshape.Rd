% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/outliers.R
\name{magnitudeshape}
\alias{magnitudeshape}
\title{Magnitude-Shape Outlier Detection for Functional Data}
\usage{
magnitudeshape(
  fdataobj,
  depth.func = depth.MBD,
  cutoff.quantile = 0.993,
  col.normal = "black",
  col.outliers = "red",
  label = "index",
  label_all = FALSE,
  ...
)
}
\arguments{
\item{fdataobj}{An object of class 'fdata'.}

\item{depth.func}{Depth function to use for computing outlyingness.
Default is depth.MBD.}

\item{cutoff.quantile}{Quantile for outlier cutoff (default 0.993).}

\item{col.normal}{Color for normal curves (default "black").}

\item{col.outliers}{Color for outlier curves (default "red").}

\item{label}{What to use for labeling outlier points. Options:
\itemize{
\item \code{"index"}: Use numeric indices (default)
\item \code{"id"}: Use observation IDs from the fdata object
\item A column name from the fdata metadata (e.g., \code{"patient_id"})
\item \code{NULL}: No labels
}}

\item{label_all}{Logical. If TRUE, label all points, not just outliers. Default FALSE.}

\item{...}{Additional arguments passed to depth function.}
}
\value{
A list of class 'magnitudeshape' with components:
\describe{
\item{MO}{Magnitude outlyingness values}
\item{VO}{Shape (variability) outlyingness values}
\item{outliers}{Indices of detected outliers}
\item{cutoff}{Chi-squared cutoff value used}
\item{plot}{The ggplot object}
}
}
\description{
Performs Magnitude-Shape (MS) outlier detection for functional data.
Each curve is represented as a point in 2D space where the x-axis
represents magnitude outlyingness and the y-axis represents shape outlyingness.
}
\details{
The MS plot (Dai & Genton, 2019) decomposes functional outlyingness into:
\itemize{
\item \strong{Magnitude Outlyingness (MO)}: Based on pointwise median of
directional outlyingness - captures shift outliers
\item \strong{Shape Outlyingness (VO)}: Based on variability of directional
outlyingness - captures shape outliers
}

Outliers are detected using the chi-squared distribution with cutoff at
the specified quantile.
}
\examples{
# Create functional data with outliers
set.seed(42)
t <- seq(0, 1, length.out = 50)
X <- matrix(0, 30, 50)
for (i in 1:28) X[i, ] <- sin(2*pi*t) + rnorm(50, sd = 0.2)
X[29, ] <- sin(2*pi*t) + 2  # Magnitude outlier
X[30, ] <- sin(4*pi*t)       # Shape outlier
fd <- fdata(X, argvals = t)

# Create MS plot
ms <- magnitudeshape(fd)

# With IDs and metadata
fd <- fdata(X, argvals = t, id = paste0("curve_", 1:30))
ms <- magnitudeshape(fd, label = "id")
}
\references{
Dai, W. and Genton, M.G. (2019). Directional outlyingness for multivariate
functional data. \emph{Computational Statistics & Data Analysis}, 131, 50-65.
}
