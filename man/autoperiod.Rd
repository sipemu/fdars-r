% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{autoperiod}
\alias{autoperiod}
\title{Autoperiod: Hybrid FFT + ACF Period Detection}
\usage{
autoperiod(
  fdataobj,
  n_candidates = 5,
  gradient_steps = 10,
  detrend_method = c("none", "linear", "auto")
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{n_candidates}{Maximum number of FFT peaks to consider as candidates.
Default: 5. More candidates increases robustness but also computation time.}

\item{gradient_steps}{Number of gradient ascent steps for period refinement.
Default: 10. More steps improves precision.}

\item{detrend_method}{Detrending method to apply before period estimation:
\describe{
\item{"none"}{No detrending (default)}
\item{"linear"}{Remove linear trend}
\item{"auto"}{Automatic AIC-based selection of detrending method}
}}
}
\value{
A list of class "autoperiod_result" with components:
\describe{
\item{period}{Best detected period}
\item{confidence}{Combined confidence (normalized FFT power * ACF validation)}
\item{fft_power}{FFT power at the detected period}
\item{acf_validation}{ACF validation score (0-1)}
\item{n_candidates}{Number of candidates evaluated}
\item{candidates}{Data frame of all candidate periods with their scores}
}
}
\description{
Implements the Autoperiod algorithm (Vlachos et al. 2005) which combines
FFT-based candidate detection with ACF validation and gradient ascent
refinement for robust period estimation.
}
\details{
The Autoperiod algorithm works in three stages:
\enumerate{
\item \strong{Candidate Detection}: Finds peaks in the FFT periodogram
\item \strong{ACF Validation}: Validates each candidate using the
autocorrelation function. Checks that the ACF shows a peak at the
candidate period, and applies harmonic analysis to distinguish
fundamental periods from harmonics.
\item \strong{Gradient Refinement}: Refines each candidate using gradient
ascent on the ACF to find the exact period that maximizes the ACF peak.
}

The final period is chosen based on the product of normalized FFT power
and ACF validation score.
}
\examples{
# Generate seasonal data with period = 2
t <- seq(0, 20, length.out = 400)
X <- matrix(sin(2 * pi * t / 2) + 0.1 * rnorm(400), nrow = 1)
fd <- fdata(X, argvals = t)

# Detect period using Autoperiod
result <- autoperiod(fd)
print(result)

# View all candidates
print(result$candidates)
}
\references{
Vlachos, M., Yu, P., & Castelli, V. (2005). On periodicity detection and
structural periodic similarity. In Proceedings of the 2005 SIAM
International Conference on Data Mining.
}
\seealso{
\code{\link{sazed}} for an ensemble method,
\code{\link{estimate.period}} for simpler single-method estimation
}
