% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{cfd.autoperiod}
\alias{cfd.autoperiod}
\title{CFDAutoperiod: Clustered Filtered Detrended Autoperiod}
\usage{
cfd.autoperiod(fdataobj, cluster_tolerance = 0.1, min_cluster_size = 1)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{cluster_tolerance}{Relative tolerance for clustering nearby period
candidates. Default: 0.1 (10\% relative difference). Candidates within
this tolerance are grouped into clusters.}

\item{min_cluster_size}{Minimum number of candidates required to form a
valid cluster. Default: 1.}
}
\value{
A list of class "cfd_autoperiod_result" with components:
\describe{
\item{period}{Primary detected period (best validated cluster center)}
\item{confidence}{Combined confidence (ACF validation * spectral power)}
\item{acf_validation}{ACF validation score for the primary period}
\item{n_periods}{Number of validated period clusters}
\item{periods}{All detected period cluster centers}
\item{confidences}{Confidence scores for each detected period}
}
}
\description{
Implements the CFDAutoperiod algorithm (Puech et al. 2020) which applies
first-order differencing for detrending, then uses density-based clustering
of spectral peaks and ACF validation on the original signal.
}
\details{
The CFDAutoperiod algorithm works in five stages:
\enumerate{
\item \strong{Differencing}: First-order differencing removes polynomial trends
\item \strong{FFT}: Computes periodogram on the detrended signal
\item \strong{Peak Detection}: Finds all peaks above the noise floor
\item \strong{Clustering}: Groups nearby period candidates into clusters
\item \strong{ACF Validation}: Validates cluster centers using the ACF
of the original (non-differenced) signal
}

This method is particularly effective for:
\itemize{
\item Signals with strong polynomial trends
\item Multiple concurrent periodicities
\item Signals where spectral leakage creates nearby spurious peaks
}
}
\examples{
# Generate data with trend
t <- seq(0, 20, length.out = 400)
X <- matrix(0.2 * t + sin(2 * pi * t / 2), nrow = 1)
fd <- fdata(X, argvals = t)

# CFDAutoperiod handles trends via differencing
result <- cfd.autoperiod(fd)
print(result)

# Multiple periods detected
X2 <- matrix(sin(2 * pi * t / 2) + 0.5 * sin(2 * pi * t / 5), nrow = 1)
fd2 <- fdata(X2, argvals = t)
result2 <- cfd.autoperiod(fd2)
print(result2$periods)  # All detected periods
}
\references{
Puech, T., Boussard, M., D'Amato, A., & Millerand, G. (2020). A fully
automated periodicity detection in time series. In Advanced Analytics
and Learning on Temporal Data (pp. 43-54). Springer.
}
\seealso{
\code{\link{autoperiod}} for the original Autoperiod algorithm,
\code{\link{sazed}} for an ensemble method
}
