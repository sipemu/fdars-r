% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{simFunData}
\alias{simFunData}
\title{Simulate Functional Data via Karhunen-Loeve Expansion}
\usage{
simFunData(
  n,
  argvals,
  M,
  eFun.type = c("Fourier", "Poly", "PolyHigh", "Wiener"),
  eVal.type = c("linear", "exponential", "wiener"),
  mean = NULL,
  seed = NULL
)
}
\arguments{
\item{n}{Number of curves to generate.}

\item{argvals}{Numeric vector of evaluation points.}

\item{M}{Number of basis functions (eigenfunctions) to use.}

\item{eFun.type}{Type of eigenfunction basis: \code{"Fourier"},
\code{"Poly"}, \code{"PolyHigh"}, or \code{"Wiener"}.}

\item{eVal.type}{Type of eigenvalue decay: \code{"linear"},
\code{"exponential"}, or \code{"wiener"}.}

\item{mean}{Mean function. Can be:
\itemize{
\item \code{NULL} for zero mean
\item A numeric vector of length equal to \code{argvals}
\item A function that takes \code{argvals} as input
}}

\item{seed}{Optional integer random seed for reproducibility.}
}
\value{
An \code{fdata} object containing the simulated functional data.
}
\description{
Generates functional data samples using a truncated Karhunen-Loeve
representation: \code{f_i(t) = mean(t) + sum_{k=1}^M xi_{ik} * phi_k(t)}
where \code{xi_{ik} ~ N(0, lambda_k)}.
}
\details{
The Karhunen-Loeve expansion provides a natural way to simulate
Gaussian functional data with a specified covariance structure.
The eigenvalues control the variance contribution of each mode,
while the eigenfunctions determine the shape of variation.

The theoretical covariance function is:
\code{Cov(X(s), X(t)) = sum_{k=1}^M lambda_k * phi_k(s) * phi_k(t)}
}
\examples{
t <- seq(0, 1, length.out = 100)

# Basic simulation with Fourier basis
fd <- simFunData(n = 20, argvals = t, M = 5,
                 eFun.type = "Fourier", eVal.type = "linear")
plot(fd, main = "Simulated Functional Data (Fourier, Linear)")

# Smoother curves with exponential decay
fd_smooth <- simFunData(n = 20, argvals = t, M = 10,
                        eFun.type = "Fourier", eVal.type = "exponential")
plot(fd_smooth, main = "Smooth Simulated Data (Exponential Decay)")

# Wiener process simulation
fd_wiener <- simFunData(n = 20, argvals = t, M = 10,
                        eFun.type = "Wiener", eVal.type = "wiener", seed = 42)
plot(fd_wiener, main = "Wiener Process Simulation")

# With mean function
mean_fn <- function(t) sin(2 * pi * t)
fd_mean <- simFunData(n = 20, argvals = t, M = 5, mean = mean_fn, seed = 42)
plot(fd_mean, main = "Simulated Data with Sinusoidal Mean")
}
\seealso{
\code{\link{eFun}}, \code{\link{eVal}}, \code{\link{addError}},
\code{\link{make.gaussian.process}}
}
