% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/basis.R
\name{fdata2basis_cv}
\alias{fdata2basis_cv}
\title{Cross-Validation for Basis Function Number Selection}
\usage{
fdata2basis_cv(
  fdataobj,
  nbasis.range = 4:20,
  type = c("bspline", "fourier"),
  criterion = c("GCV", "CV", "AIC", "BIC"),
  kfold = 10,
  lambda = 0
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{nbasis.range}{Vector of nbasis values to evaluate (default: 4:20).}

\item{type}{Basis type: "bspline" (default) or "fourier".}

\item{criterion}{Selection criterion: "GCV" (default), "CV", "AIC", or "BIC".}

\item{kfold}{Number of folds for k-fold CV (default 10). Ignored if
criterion is "GCV", "AIC", or "BIC".}

\item{lambda}{Smoothing parameter (default 0).}
}
\value{
A list with:
\describe{
\item{optimal.nbasis}{Optimal number of basis functions}
\item{scores}{Score for each nbasis value}
\item{nbasis.range}{The tested nbasis values}
\item{criterion}{The criterion used}
\item{fitted}{fdata object fitted with optimal nbasis}
}
}
\description{
Selects the optimal number of basis functions using k-fold cross-validation
or generalized cross-validation.
}
\examples{
set.seed(42)
t <- seq(0, 1, length.out = 50)
X <- matrix(0, 20, 50)
for (i in 1:20) X[i, ] <- sin(4 * pi * t) + rnorm(50, sd = 0.1)
fd <- fdata(X, argvals = t)

# Find optimal nbasis
cv_result <- fdata2basis_cv(fd, nbasis.range = 5:15, type = "fourier")
print(cv_result$optimal.nbasis)
}
