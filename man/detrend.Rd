% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{detrend}
\alias{detrend}
\title{Remove Trend from Functional Data}
\usage{
detrend(
  fdataobj,
  method = c("linear", "polynomial", "diff1", "diff2", "loess", "auto"),
  degree = 2,
  bandwidth = 0.3,
  return_trend = FALSE
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{method}{Detrending method:
\describe{
\item{"linear"}{Least squares linear fit (default)}
\item{"polynomial"}{Polynomial regression of specified degree}
\item{"diff1"}{First-order differencing}
\item{"diff2"}{Second-order differencing}
\item{"loess"}{Local polynomial regression (LOESS)}
\item{"auto"}{Automatic selection via AIC}
}}

\item{degree}{Polynomial degree for "polynomial" method. Default: 2.}

\item{bandwidth}{Bandwidth as fraction of data range for "loess" method.
Default: 0.3.}

\item{return_trend}{Logical. If TRUE, return both trend and detrended data.
Default: FALSE.}
}
\value{
If return_trend = FALSE, an fdata object with detrended data.
If return_trend = TRUE, a list with components:
\describe{
\item{detrended}{fdata object with detrended data}
\item{trend}{fdata object with estimated trend}
\item{method}{Method used for detrending}
\item{rss}{Residual sum of squares per curve}
}
}
\description{
Removes trend from functional data using various methods. This is useful
for preprocessing data before seasonal analysis when the data has a
significant trend component.
}
\details{
For series with polynomial trends, "linear" or "polynomial" methods are
appropriate. For more complex trends, "loess" provides flexibility.
The "auto" method compares linear, polynomial (degree 2 and 3), and LOESS,
selecting the method with lowest AIC.

Differencing methods ("diff1", "diff2") reduce the series length by 1 or 2
points respectively. The resulting fdata has correspondingly shorter argvals.
}
\examples{
# Generate data with linear trend and seasonal component
t <- seq(0, 10, length.out = 200)
X <- matrix(2 + 0.5 * t + sin(2 * pi * t / 2), nrow = 1)
fd <- fdata(X, argvals = t)

# Detrend with linear method
fd_detrended <- detrend(fd, method = "linear")

# Now estimate period on detrended data
period <- estimate.period(fd_detrended)
print(period$period)  # Should be close to 2

# Get both trend and detrended data
result <- detrend(fd, method = "linear", return_trend = TRUE)
# plot(result$trend)  # Shows the linear trend
}
\seealso{
\code{\link{decompose}} for full seasonal decomposition
}
