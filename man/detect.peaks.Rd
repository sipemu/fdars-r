% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{detect.peaks}
\alias{detect.peaks}
\title{Detect Peaks in Functional Data}
\usage{
detect.peaks(
  fdataobj,
  min_distance = NULL,
  min_prominence = NULL,
  smooth_first = FALSE,
  smooth_nbasis = NULL,
  detrend_method = c("none", "linear", "auto")
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{min_distance}{Minimum time between peaks. Default: NULL (no constraint).}

\item{min_prominence}{Minimum prominence for a peak (0-1 scale). Peaks with
lower prominence are filtered out. Default: NULL (no filter).}

\item{smooth_first}{Logical. If TRUE, apply Fourier basis smoothing before
peak detection. Recommended for noisy data. Default: FALSE.}

\item{smooth_nbasis}{Number of Fourier basis functions for smoothing.
If NULL and smooth_first=TRUE, uses GCV to automatically select
optimal nbasis (range 5-25). Default: NULL (auto).}

\item{detrend_method}{Detrending method to apply before peak detection:
\describe{
\item{"none"}{No detrending (default)}
\item{"linear"}{Remove linear trend}
\item{"auto"}{Automatic AIC-based selection of detrending method}
}}
}
\value{
A list with components:
\describe{
\item{peaks}{List of data frames, one per curve, with columns: time, value, prominence}
\item{inter_peak_distances}{List of numeric vectors with distances between consecutive peaks}
\item{mean_period}{Mean inter-peak distance across all curves (estimates period)}
}
}
\description{
Detects local maxima (peaks) in functional data using derivative
zero-crossings. Returns peak times, values, and prominence measures.
}
\details{
Peak prominence measures how much a peak stands out from its surroundings.
It is computed as the height difference between the peak and the highest
of the two minimum values on either side, normalized by the data range.

Fourier basis smoothing is ideal for seasonal signals because it naturally
captures periodic patterns without introducing boundary artifacts.

For data with trends, use detrend_method to remove the trend before
detecting peaks. This prevents the trend from affecting peak prominence
calculations.
}
\examples{
# Generate data with clear peaks
t <- seq(0, 10, length.out = 200)
X <- matrix(sin(2 * pi * t / 2), nrow = 1)
fd <- fdata(X, argvals = t)

# Detect peaks
peaks <- detect.peaks(fd, min_distance = 1.5)
print(peaks$mean_period)  # Should be close to 2

# With automatic Fourier smoothing (GCV selects nbasis)
peaks_smooth <- detect.peaks(fd, min_distance = 1.5, smooth_first = TRUE)

# With detrending for trending data
X_trend <- matrix(2 + 0.5 * t + sin(2 * pi * t / 2), nrow = 1)
fd_trend <- fdata(X_trend, argvals = t)
peaks_det <- detect.peaks(fd_trend, detrend_method = "linear")
}
