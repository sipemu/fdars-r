% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/outliers.R
\name{outliers.depth.pond}
\alias{outliers.depth.pond}
\title{Outlier Detection for Functional Data}
\usage{
outliers.depth.pond(
  fdataobj,
  nb = 200,
  dfunc = depth.mode,
  threshold_method = c("quantile", "mad", "iqr"),
  quan = 0.05,
  k = NULL,
  ...
)
}
\arguments{
\item{fdataobj}{An object of class 'fdata'.}

\item{nb}{Number of bootstrap samples. Default is 200.}

\item{dfunc}{Depth function to use. Default is depth.mode.}

\item{threshold_method}{Method for computing the outlier threshold. Options:
\describe{
\item{"quantile"}{Use quantile of weighted depths (default). Curves with
depth below this quantile are flagged as outliers.}
\item{"mad"}{Use median - k * MAD of weighted depths. More robust to
existing outliers in the data.}
\item{"iqr"}{Use Q1 - k * IQR, similar to boxplot whiskers.}
}}

\item{quan}{Quantile for outlier cutoff when \code{threshold_method = "quantile"}.
Default is 0.05, meaning curves with depth in the bottom 5\% are flagged
(95th percentile threshold). Lower values detect fewer outliers.}

\item{k}{Multiplier for MAD or IQR methods. Default is 2.5 for MAD and 1.5
for IQR. Higher values detect fewer outliers.}

\item{...}{Additional arguments passed to depth function.}
}
\value{
A list of class 'outliers.fdata' with components:
\describe{
\item{outliers}{Indices of detected outliers}
\item{depths}{Depth values for all curves}
\item{weighted_depths}{Bootstrap-weighted depth values}
\item{cutoff}{Depth cutoff used}
\item{threshold_method}{Method used for threshold computation}
\item{fdataobj}{Original fdata object}
}
}
\description{
Functions for detecting outliers in functional data using depth measures.
Outlier Detection using Weighted Depth
}
\details{
Detects outliers based on depth with bootstrap resampling. The threshold
for outlier detection can be computed using different methods.

The function first computes depth values for all curves, then uses bootstrap
resampling to obtain weighted depths that are more robust to sampling variability.

\strong{Threshold Methods:}
\itemize{
\item \strong{quantile}: Flags curves with depth below the specified quantile.
With \code{quan = 0.1}, approximately 10\% of curves would be flagged under
the null hypothesis of no outliers. Suitable when you expect a specific
proportion of outliers.
\item \strong{mad}: Uses \code{median(depths) - k * MAD(depths)} as threshold.
More robust because MAD is not influenced by extreme values. With k = 2.5,
this corresponds roughly to a 1-2\% false positive rate under normality.
\item \strong{iqr}: Uses \code{Q1 - k * IQR} as threshold, similar to boxplot
outlier detection. With k = 1.5, corresponds to the standard boxplot fence.
}
}
\examples{
# Create data with outliers
set.seed(42)
t <- seq(0, 1, length.out = 50)
X <- matrix(0, 30, 50)
for (i in 1:28) X[i, ] <- sin(2*pi*t) + rnorm(50, sd = 0.2)
X[29, ] <- sin(2*pi*t) + 3  # outlier
X[30, ] <- -sin(2*pi*t)     # outlier
fd <- fdata(X, argvals = t)

# Default: quantile method with 95th percentile (bottom 5\%)
out1 <- outliers.depth.pond(fd, nb = 50)

# More permissive: bottom 10\%
out1b <- outliers.depth.pond(fd, nb = 50, quan = 0.1)

# MAD method (more robust)
out2 <- outliers.depth.pond(fd, nb = 50, threshold_method = "mad", k = 2.5)

# IQR method (boxplot-like)
out3 <- outliers.depth.pond(fd, nb = 50, threshold_method = "iqr", k = 1.5)
}
