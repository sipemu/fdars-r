% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{matrix.profile}
\alias{matrix.profile}
\title{Matrix Profile for Motif Discovery and Period Detection}
\usage{
matrix.profile(fdataobj, subsequence_length = NULL, exclusion_zone = 0.5)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{subsequence_length}{Length of subsequences to compare. If NULL,
automatically determined as approximately 1/4 of series length.}

\item{exclusion_zone}{Fraction of subsequence length to exclude around each
position to prevent trivial self-matches. Default: 0.5.}
}
\value{
A list of class "matrix_profile_result" with components:
\describe{
\item{profile}{Numeric vector of minimum z-normalized distances at each position}
\item{profile_index}{Integer vector of nearest neighbor indices (1-based)}
\item{subsequence_length}{Subsequence length used}
\item{detected_periods}{Candidate periods detected from arc analysis (top 5)}
\item{arc_counts}{Arc counts at each index distance (for diagnostics)}
\item{primary_period}{Most prominent detected period}
\item{confidence}{Confidence score (0-1) based on arc prominence}
}
}
\description{
Computes the Matrix Profile using the STOMP (Scalable Time series Ordered-search
Matrix Profile) algorithm. The Matrix Profile stores the z-normalized Euclidean
distance between each subsequence and its nearest neighbor, enabling efficient
motif discovery and period detection for non-sinusoidal patterns.
}
\details{
The Matrix Profile algorithm (Yeh et al., 2016; Zhu et al., 2016) is particularly
suited for:
\itemize{
\item Non-sinusoidal repeating patterns (unlike FFT/spectral methods)
\item Motif discovery (finding repeated subsequences)
\item Anomaly detection (subsequences with no good match)
}

The STOMP variant uses O(n^2) time complexity but is highly cache-efficient.
For very long series (>10000 points), consider downsampling.

Period detection is based on "arc analysis": counting how often the nearest
neighbor is a fixed distance away. Peaks in arc counts indicate periodicity.
}
\examples{
# Periodic sawtooth wave (non-sinusoidal)
t <- seq(0, 10, length.out = 200)
period <- 2
X <- matrix((t \%\% period) / period, nrow = 1)
fd <- fdata(X, argvals = t)

# Compute Matrix Profile
result <- matrix.profile(fd, subsequence_length = 30)
print(result)
plot(result)

# Sine wave for comparison
X_sine <- matrix(sin(2 * pi * t / period), nrow = 1)
fd_sine <- fdata(X_sine, argvals = t)
result_sine <- matrix.profile(fd_sine, subsequence_length = 30)

}
\references{
Yeh, C. C. M., et al. (2016). Matrix profile I: All pairs similarity joins
for time series: A unifying view that includes motifs, discords and shapelets.
ICDM 2016.

Zhu, Y., et al. (2016). Matrix profile II: Exploiting a novel algorithm and
GPUs to break the one hundred million barrier for time series motifs and joins.
ICDM 2016.
}
\seealso{
\code{\link{estimate.period}}, \code{\link{sazed}}, \code{\link{lomb.scargle}}
}
