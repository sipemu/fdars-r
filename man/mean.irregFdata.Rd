% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/irregFdata.R
\name{mean.irregFdata}
\alias{mean.irregFdata}
\title{Estimate Mean Function for Irregular Data}
\usage{
\method{mean}{irregFdata}(
  x,
  argvals = NULL,
  method = c("basis", "kernel"),
  nbasis = 15,
  type = c("bspline", "fourier"),
  bandwidth = NULL,
  kernel = c("epanechnikov", "gaussian"),
  ...
)
}
\arguments{
\item{x}{An object of class \code{irregFdata}.}

\item{argvals}{Target grid for mean estimation. If \code{NULL}, uses
a regular grid of 100 points.}

\item{method}{Estimation method: \code{"basis"} (default, recommended) fits
basis functions to each curve then averages; \code{"kernel"} uses
Nadaraya-Watson kernel smoothing.}

\item{nbasis}{Number of basis functions for \code{method = "basis"} (default 15).}

\item{type}{Basis type for \code{method = "basis"}: \code{"bspline"} (default)
or \code{"fourier"}.}

\item{bandwidth}{Kernel bandwidth for \code{method = "kernel"}. If \code{NULL},
uses range/10.}

\item{kernel}{Kernel type for \code{method = "kernel"}: \code{"epanechnikov"}
(default) or \code{"gaussian"}.}

\item{...}{Additional arguments (ignored).}
}
\value{
An \code{fdata} object containing the estimated mean function.
}
\description{
Estimates the mean function from irregularly sampled functional data.
}
\details{
The \code{"basis"} method (default) works by:
\enumerate{
\item Fitting basis functions to each curve via least squares
\item Reconstructing each curve on the target grid
\item Averaging the reconstructed curves
}
This approach preserves the functional structure and typically gives
more accurate estimates than kernel smoothing.

The \code{"kernel"} method uses Nadaraya-Watson estimation, pooling all
observations across curves. This is faster but may be less accurate
for structured functional data.
}
\examples{
t <- seq(0, 1, length.out = 100)
fd <- simFunData(n = 50, argvals = t, M = 5, seed = 42)
ifd <- sparsify(fd, minObs = 10, maxObs = 30, seed = 123)

# Recommended: basis method
mean_fd <- mean(ifd)
plot(mean_fd, main = "Estimated Mean Function")

# Alternative: kernel method
mean_kernel <- mean(ifd, method = "kernel", bandwidth = 0.1)
}
