% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{seasonal.strength}
\alias{seasonal.strength}
\title{Measure Seasonal Strength}
\usage{
seasonal.strength(
  fdataobj,
  period = NULL,
  method = c("variance", "spectral", "wavelet"),
  n_harmonics = 3,
  detrend_method = c("none", "linear", "auto")
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{period}{Known or estimated period. If NULL, period is estimated
automatically using FFT.}

\item{method}{Method for computing strength:
\describe{
\item{"variance"}{Variance decomposition: Var(seasonal) / Var(total)}
\item{"spectral"}{Spectral: power at seasonal frequencies / total power}
\item{"wavelet"}{Wavelet: Morlet wavelet power at seasonal period / total variance}
}}

\item{n_harmonics}{Number of Fourier harmonics to use (for variance method).
Default: 3.}

\item{detrend_method}{Detrending method to apply before computing strength:
\describe{
\item{"none"}{No detrending (default)}
\item{"linear"}{Remove linear trend}
\item{"auto"}{Automatic AIC-based selection of detrending method}
}}
}
\value{
A numeric value between 0 and 1 representing seasonal strength.
}
\description{
Computes the strength of seasonality in functional data. Values range from
0 (no seasonality) to 1 (pure seasonal signal).
}
\details{
The variance method decomposes the signal into a seasonal component
(using Fourier basis with the specified period) and computes the
proportion of variance explained by the seasonal component.

The spectral method computes the proportion of total spectral power
that falls at the seasonal frequency and its harmonics.

The wavelet method uses a Morlet wavelet to measure power at the target
period. It provides time-localized frequency information and is robust
to non-stationary signals.

Trends can artificially lower the seasonal strength measure by
contributing non-seasonal variance. Use detrend_method to remove
trends before computing strength.
}
\examples{
# Pure seasonal signal
t <- seq(0, 10, length.out = 200)
X <- matrix(sin(2 * pi * t / 2), nrow = 1)
fd_seasonal <- fdata(X, argvals = t)
seasonal.strength(fd_seasonal, period = 2)  # Should be close to 1

# Pure noise
X_noise <- matrix(rnorm(200), nrow = 1)
fd_noise <- fdata(X_noise, argvals = t)
seasonal.strength(fd_noise, period = 2)  # Should be close to 0

# Trending data - detrending improves strength estimate
X_trend <- matrix(2 + 0.5 * t + sin(2 * pi * t / 2), nrow = 1)
fd_trend <- fdata(X_trend, argvals = t)
seasonal.strength(fd_trend, period = 2, detrend_method = "linear")
}
