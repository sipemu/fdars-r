% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering.R
\name{cluster.optim}
\alias{cluster.optim}
\title{Optimal Number of Clusters for Functional K-Means}
\usage{
cluster.optim(
  fdataobj,
  ncl.range = 2:10,
  criterion = c("silhouette", "CH", "elbow"),
  metric = "L2",
  max.iter = 100,
  nstart = 10,
  seed = NULL,
  ...
)
}
\arguments{
\item{fdataobj}{An object of class 'fdata'.}

\item{ncl.range}{Range of number of clusters to evaluate. Default is 2:10.}

\item{criterion}{Criterion to use for selecting optimal k:
\describe{
\item{"silhouette"}{Mean silhouette coefficient (default). Higher is better.}
\item{"CH"}{Calinski-Harabasz index. Higher is better.}
\item{"elbow"}{Within-cluster sum of squares. Look for elbow in plot.}
}}

\item{metric}{Either a string ("L2", "L1", "Linf") or a metric function.}

\item{max.iter}{Maximum iterations for k-means (default 100).}

\item{nstart}{Number of random starts (default 10).}

\item{seed}{Random seed for reproducibility.}

\item{...}{Additional arguments passed to cluster.kmeans.}
}
\value{
A list of class 'cluster.optim' with components:
\describe{
\item{optimal.k}{Optimal number of clusters based on criterion}
\item{criterion}{Name of criterion used}
\item{scores}{Vector of criterion values for each k}
\item{ncl.range}{Range of k values tested}
\item{models}{List of cluster.kmeans objects for each k}
\item{best.model}{The cluster.kmeans object for optimal k}
}
}
\description{
Determines the optimal number of clusters for functional k-means clustering
using various criteria: elbow method, silhouette score, or Calinski-Harabasz index.
}
\details{
\strong{Silhouette score}: Measures how similar each curve is to its own cluster
compared to other clusters. Values range from -1 to 1, with higher being better.
Optimal k maximizes the mean silhouette.

\strong{Calinski-Harabasz index}: Ratio of between-cluster to within-cluster
dispersion. Higher values indicate better defined clusters. Optimal k maximizes CH.

\strong{Elbow method}: Plots total within-cluster sum of squares vs k. The optimal
k is at the "elbow" where adding more clusters doesn't significantly reduce WSS.
This is subjective and best assessed visually using \code{plot()}.
}
\examples{
# Create functional data with 3 groups
set.seed(42)
t <- seq(0, 1, length.out = 50)
n <- 60
X <- matrix(0, n, 50)
true_k <- rep(1:3, each = 20)
for (i in 1:n) {
  if (true_k[i] == 1) {
    X[i, ] <- sin(2*pi*t) + rnorm(50, sd = 0.1)
  } else if (true_k[i] == 2) {
    X[i, ] <- cos(2*pi*t) + rnorm(50, sd = 0.1)
  } else {
    X[i, ] <- sin(4*pi*t) + rnorm(50, sd = 0.1)
  }
}
fd <- fdata(X, argvals = t)

# Find optimal k using silhouette
opt <- cluster.optim(fd, ncl.range = 2:6, criterion = "silhouette")
print(opt)
plot(opt)
}
