% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{stl.fd}
\alias{stl.fd}
\title{STL Decomposition: Seasonal and Trend decomposition using LOESS}
\usage{
stl.fd(fdataobj, period, s.window = NULL, t.window = NULL, robust = TRUE)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{period}{Integer. The seasonal period (number of observations per cycle).}

\item{s.window}{Seasonal smoothing window. Must be odd. If NULL, defaults to 7.
Larger values produce smoother seasonal components.}

\item{t.window}{Trend smoothing window. Must be odd. If NULL, automatically
calculated based on period and s.window.}

\item{robust}{Logical. If TRUE, performs robustness iterations to downweight
outliers using bisquare weighting. Default: TRUE.}
}
\value{
A list of class "stl_result" with components:
\describe{
\item{trend}{fdata object containing trend components}
\item{seasonal}{fdata object containing seasonal components}
\item{remainder}{fdata object containing remainder (residual) components}
\item{weights}{Matrix of robustness weights (1 = full weight, 0 = outlier)}
\item{period}{The period used}
\item{s.window}{Seasonal smoothing window used}
\item{t.window}{Trend smoothing window used}
\item{inner.iterations}{Number of inner loop iterations}
\item{outer.iterations}{Number of outer (robustness) iterations}
\item{call}{The function call}
}
}
\description{
Performs STL (Seasonal and Trend decomposition using LOESS) on functional data
following Cleveland et al. (1990). This is a robust iterative procedure that
separates a time series into trend, seasonal, and remainder components.
}
\details{
The STL algorithm proceeds as follows:

\strong{Inner Loop} (repeated n.inner times):
\enumerate{
\item Detrending: Subtract current trend estimate
\item Cycle-subseries smoothing: Smooth values at each seasonal position across cycles
\item Low-pass filtering: Remove high-frequency noise
\item Detrending the smoothed cycle-subseries
\item Deseasonalizing: Subtract seasonal from original data
\item Trend smoothing: Apply LOESS to deseasonalized data
}

\strong{Outer Loop} (for robustness):
\enumerate{
\item Compute residuals from current decomposition
\item Calculate robustness weights using bisquare function
\item Re-run inner loop with weighted smoothing
}

STL is particularly effective for:
\itemize{
\item Long time series with many cycles
\item Data with outliers (when robust=TRUE)
\item Slowly changing seasonal patterns
}
}
\examples{
# Create seasonal data with trend
t <- seq(0, 20, length.out = 400)
period <- 2  # corresponds to 40 observations
period_obs <- 40
X <- matrix(0.05 * t + sin(2 * pi * t / period) + rnorm(length(t), sd = 0.2), nrow = 1)
fd <- fdata(X, argvals = t)

# Perform STL decomposition
result <- stl.fd(fd, period = period_obs)
print(result)

# Plot the decomposition
plot(result)

# Non-robust version (faster but sensitive to outliers)
result_fast <- stl.fd(fd, period = period_obs, robust = FALSE)

}
\references{
Cleveland, R. B., Cleveland, W. S., McRae, J. E., & Terpenning, I. (1990).
STL: A Seasonal-Trend Decomposition Procedure Based on Loess.
Journal of Official Statistics, 6(1), 3-73.
}
\seealso{
\code{\link{decompose}}, \code{\link{detrend}}, \code{\link{seasonal.strength}}
}
