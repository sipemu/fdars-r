% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{detect_amplitude_modulation}
\alias{detect_amplitude_modulation}
\title{Detect Amplitude Modulation in Seasonal Time Series}
\usage{
detect_amplitude_modulation(
  fdataobj,
  period,
  method = c("hilbert", "wavelet"),
  modulation_threshold = 0.15,
  seasonality_threshold = 0.3
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{period}{Seasonal period in argvals units.}

\item{method}{Method for amplitude extraction: "hilbert" (default) or "wavelet".}

\item{modulation_threshold}{Coefficient of variation threshold for detecting
modulation. Default: 0.15 (i.e., CV > 15\% indicates modulation).}

\item{seasonality_threshold}{Strength threshold for seasonality detection.
Default: 0.3.}
}
\value{
A list with components:
\describe{
\item{is_seasonal}{Logical, whether seasonality is detected}
\item{seasonal_strength}{Overall seasonal strength (spectral method)}
\item{has_modulation}{Logical, whether amplitude modulation is detected}
\item{modulation_type}{Character: "stable", "emerging", "fading",
"oscillating", or "non_seasonal"}
\item{modulation_score}{Coefficient of variation of amplitude (0 = stable)}
\item{amplitude_trend}{Trend in amplitude (-1 to 1): negative = fading,
positive = emerging}
\item{amplitude_curve}{Time-varying amplitude (fdata object)}
\item{time_points}{Time points for the amplitude curve}
}
}
\description{
Detects whether the amplitude of a seasonal pattern changes over time
(amplitude modulation). Uses either Hilbert transform or wavelet analysis
to extract the time-varying amplitude envelope.
}
\details{
The function first checks if seasonality is present using the spectral
method (which is robust to amplitude modulation). If seasonality is
detected, it extracts the amplitude envelope and analyzes its variation.

\strong{Hilbert method}: Uses Hilbert transform to compute the analytic
signal and extract instantaneous amplitude. Fast but assumes narrowband
signals.

\strong{Wavelet method}: Uses Morlet wavelet transform at the target
period. More robust to noise and non-stationarity.

\strong{Modulation types}:
\itemize{
\item \code{stable}: Constant amplitude (modulation_score < threshold)
\item \code{emerging}: Amplitude increases over time (amplitude_trend > 0.3)
\item \code{fading}: Amplitude decreases over time (amplitude_trend < -0.3)
\item \code{oscillating}: Amplitude varies but no clear trend
\item \code{non_seasonal}: No seasonality detected
}
}
\examples{
# Generate data with emerging seasonality
t <- seq(0, 1, length.out = 200)
amplitude <- 0.2 + 0.8 * t  # Amplitude grows over time
X <- matrix(amplitude * sin(2 * pi * t / 0.2), nrow = 1)
fd <- fdata(X, argvals = t)

result <- detect_amplitude_modulation(fd, period = 0.2)
print(result$modulation_type)  # "emerging"
print(result$amplitude_trend)  # Positive value

# Compare Hilbert vs Wavelet methods
result_hilbert <- detect_amplitude_modulation(fd, period = 0.2, method = "hilbert")
result_wavelet <- detect_amplitude_modulation(fd, period = 0.2, method = "wavelet")
}
