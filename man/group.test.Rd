% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fdata.R
\name{group.test}
\alias{group.test}
\title{Permutation Test for Group Differences}
\usage{
group.test(
  fdataobj,
  groups,
  n.perm = 1000,
  statistic = c("centroid", "ratio"),
  ...
)
}
\arguments{
\item{fdataobj}{An object of class 'fdata'.}

\item{groups}{A factor or character vector specifying group membership.}

\item{n.perm}{Number of permutations (default 1000).}

\item{statistic}{Test statistic: "centroid" (distance between group means) or
"ratio" (between/within group variance ratio).}

\item{...}{Additional arguments passed to distance functions.}
}
\value{
An object of class 'group.test' containing:
\describe{
\item{statistic}{Observed test statistic}
\item{p.value}{Permutation p-value}
\item{perm.dist}{Permutation distribution of test statistic}
\item{n.perm}{Number of permutations used}
}
}
\description{
Tests whether groups of functional data are significantly different using
permutation testing.
}
\details{
\strong{Null Hypothesis (H0):} All groups come from the same distribution. That is,
the group labels are exchangeable and there is no systematic difference between
the functional curves in different groups.

\strong{Alternative Hypothesis (H1):} At least one group differs from the others in
terms of location (mean function) or dispersion.

The test works by:
\enumerate{
\item Computing a test statistic on the observed data
\item Repeatedly permuting the group labels and recomputing the statistic
\item Calculating the p-value as the proportion of permuted statistics >= observed
}

Two test statistics are available:
\itemize{
\item \code{"centroid"}: Sum of pairwise L2 distances between group mean
functions. Sensitive to differences in group locations (means).
\item \code{"ratio"}: Ratio of between-group to within-group variance,
similar to an F-statistic. Sensitive to both location and dispersion.
}

A small p-value (e.g., < 0.05) indicates evidence against H0, suggesting
that the groups are significantly different.
}
\examples{
\donttest{
set.seed(42)
n <- 30
m <- 50
t_grid <- seq(0, 1, length.out = m)
X <- matrix(0, n, m)
for (i in 1:15) X[i, ] <- sin(2 * pi * t_grid) + rnorm(m, sd = 0.1)
for (i in 16:30) X[i, ] <- cos(2 * pi * t_grid) + rnorm(m, sd = 0.1)
fd <- fdata(X, argvals = t_grid)
groups <- factor(rep(c("A", "B"), each = 15))

# Test for significant difference
gt <- group.test(fd, groups, n.perm = 500)
print(gt)
}
}
