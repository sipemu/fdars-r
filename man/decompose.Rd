% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seasonal.R
\name{decompose}
\alias{decompose}
\title{Seasonal-Trend Decomposition}
\usage{
decompose(
  fdataobj,
  period = NULL,
  method = c("additive", "multiplicative"),
  trend_method = c("loess", "spline"),
  bandwidth = 0.3,
  n_harmonics = 3
)
}
\arguments{
\item{fdataobj}{An fdata object.}

\item{period}{Seasonal period. If NULL, estimated automatically using FFT.}

\item{method}{Decomposition method:
\describe{
\item{"additive"}{data = trend + seasonal + remainder (default)}
\item{"multiplicative"}{data = trend * seasonal * remainder}
}}

\item{trend_method}{Method for trend extraction: "loess" or "spline".
Default: "loess".}

\item{bandwidth}{Bandwidth for trend extraction (fraction of range).
Default: 0.3.}

\item{n_harmonics}{Number of Fourier harmonics for seasonal component.
Default: 3.}
}
\value{
A list with components:
\describe{
\item{trend}{fdata object with trend component}
\item{seasonal}{fdata object with seasonal component}
\item{remainder}{fdata object with remainder/residual}
\item{period}{Period used for decomposition}
\item{method}{Decomposition method ("additive" or "multiplicative")}
}
}
\description{
Decomposes functional data into trend, seasonal, and remainder components.
Similar to STL (Seasonal-Trend decomposition using LOESS).
}
\details{
For additive decomposition: data = trend + seasonal + remainder.
The trend is extracted using LOESS or spline smoothing, then the seasonal
component is estimated by fitting Fourier harmonics to the detrended data.

For multiplicative decomposition: data = trend * seasonal * remainder.
This is achieved by log-transforming the data, applying additive
decomposition, and back-transforming. Use this when the seasonal amplitude
grows with the trend level.
}
\examples{
# Additive seasonal pattern
t <- seq(0, 20, length.out = 400)
X <- matrix(2 + 0.3 * t + sin(2 * pi * t / 2.5), nrow = 1)
fd <- fdata(X, argvals = t)

result <- decompose(fd, period = 2.5, method = "additive")
# plot(result$trend)      # Linear trend
# plot(result$seasonal)   # Sinusoidal seasonal
# plot(result$remainder)  # Residual noise

# Multiplicative pattern (amplitude grows with level)
X_mult <- matrix((2 + 0.3 * t) * (1 + 0.3 * sin(2 * pi * t / 2.5)), nrow = 1)
fd_mult <- fdata(X_mult, argvals = t)

result_mult <- decompose(fd_mult, period = 2.5, method = "multiplicative")
}
\seealso{
\code{\link{detrend}} for simple trend removal,
\code{\link{seasonal.strength}} for measuring seasonality
}
